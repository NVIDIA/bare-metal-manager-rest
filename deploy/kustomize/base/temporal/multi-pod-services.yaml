# SPDX-FileCopyrightText: Copyright (c) 2021-2023 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: LicenseRef-NvidiaProprietary
#
# NVIDIA CORPORATION, its affiliates and licensors retain all intellectual
# property and proprietary rights in and to this material, related
# documentation and any modifications thereto. Any use, reproduction,
# disclosure or distribution of this material and related documentation
# without an express license agreement from NVIDIA CORPORATION or
# its affiliates is strictly prohibited.

# Temporal Services for multi-pod deployment

---
# Frontend Service (main entry point for clients)
apiVersion: v1
kind: Service
metadata:
  name: temporal-frontend
  labels:
    app: temporal
    component: frontend
spec:
  type: ClusterIP
  ports:
    - port: 7233
      targetPort: 7233
      name: grpc
    - port: 6933
      targetPort: 6933
      name: membership
  selector:
    app: temporal
    component: frontend

---
# Headless service for frontend membership discovery
apiVersion: v1
kind: Service
metadata:
  name: temporal-frontend-headless
  labels:
    app: temporal
    component: frontend
spec:
  clusterIP: None
  ports:
    - port: 7233
      targetPort: 7233
      name: grpc
    - port: 6933
      targetPort: 6933
      name: membership
  selector:
    app: temporal
    component: frontend

---
# History Service
apiVersion: v1
kind: Service
metadata:
  name: temporal-history
  labels:
    app: temporal
    component: history
spec:
  type: ClusterIP
  ports:
    - port: 7234
      targetPort: 7234
      name: grpc
    - port: 6934
      targetPort: 6934
      name: membership
  selector:
    app: temporal
    component: history

---
# Headless service for history membership discovery
apiVersion: v1
kind: Service
metadata:
  name: temporal-history-headless
  labels:
    app: temporal
    component: history
spec:
  clusterIP: None
  ports:
    - port: 7234
      targetPort: 7234
      name: grpc
    - port: 6934
      targetPort: 6934
      name: membership
  selector:
    app: temporal
    component: history

---
# Matching Service
apiVersion: v1
kind: Service
metadata:
  name: temporal-matching
  labels:
    app: temporal
    component: matching
spec:
  type: ClusterIP
  ports:
    - port: 7235
      targetPort: 7235
      name: grpc
    - port: 6935
      targetPort: 6935
      name: membership
  selector:
    app: temporal
    component: matching

---
# Headless service for matching membership discovery
apiVersion: v1
kind: Service
metadata:
  name: temporal-matching-headless
  labels:
    app: temporal
    component: matching
spec:
  clusterIP: None
  ports:
    - port: 7235
      targetPort: 7235
      name: grpc
    - port: 6935
      targetPort: 6935
      name: membership
  selector:
    app: temporal
    component: matching

---
# Worker Service
apiVersion: v1
kind: Service
metadata:
  name: temporal-worker
  labels:
    app: temporal
    component: worker
spec:
  type: ClusterIP
  ports:
    - port: 7239
      targetPort: 7239
      name: grpc
    - port: 6939
      targetPort: 6939
      name: membership
  selector:
    app: temporal
    component: worker

---
# Headless service for worker membership discovery
apiVersion: v1
kind: Service
metadata:
  name: temporal-worker-headless
  labels:
    app: temporal
    component: worker
spec:
  clusterIP: None
  ports:
    - port: 7239
      targetPort: 7239
      name: grpc
    - port: 6939
      targetPort: 6939
      name: membership
  selector:
    app: temporal
    component: worker

---
# Main Temporal service (alias for frontend - for backward compatibility)
apiVersion: v1
kind: Service
metadata:
  name: temporal
  labels:
    app: temporal
spec:
  type: ClusterIP
  ports:
    - port: 7233
      targetPort: 7233
      name: grpc
  selector:
    app: temporal
    component: frontend
